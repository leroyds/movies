{% extends 'base.html'%}
{% load static%}
{%load custom_tags%}

{% load ratings %}

{% block title %}Movie Reviews{% endblock %}

{% block content %}
    <div class='row'>
    {% for post in post_list %}
        <div class="col-4 mt-4 border">
            <h3 class=""><a href="{{ post.get_absolute_url }}">{{post.title}}</a></h3>
            <img src="{{post.image.url}}" alt="article image">
            <p class="">Release Date: {{post.release_date}}</p>
            {%AVERAGE_RATINGS post.pk as AVERAGE%}
            
            <p>Ratings:
                    {% ratings post %}
                {%if AVERAGE.avg_rating%}
                {{AVERAGE.avg_rating}}</p>
                
                {%else%}
                0
                {%endif%}
            <p>Genre: 
                    {% for tag in post.tags.all %}
                    <a href="{% url 'post:list_slug' tag_slug=tag.slug %}">
                    {{ tag.name }}
                    </a>
                    {% if not forloop.last %}, {% endif %}
                    {% endfor %}
            </p>
            <!--  -->
        </div>

        {%empty%}
            <p>No Movies Post yet!</p>
    {% endfor %}
    </div>

    {%include 'pagination.html' with page=page_obj%}
{% endblock %}
